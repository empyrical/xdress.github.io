


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>xdress.doxygen &mdash; xdress 0.4-rc1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/numpy_friendly.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.4-rc1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="../../_static/cloud.js"></script>
    <link rel="top" title="xdress 0.4-rc1 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1"><script type="text/javascript">
var ga_enabled = !$.cookie('disable-ga');
if(ga_enabled){
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-41934829-1']);
  _gaq.push(['_setCookiePath', '/']);
  _gaq.push(['_setDetectFlash', false]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
}
</script>
  </head>
  <body>
    <div class="relbar-top">
        
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../../np-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
    <li><a href="../../index.html">xdress 0.4-rc1 documentation</a> &raquo;</li>

          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for xdress.doxygen</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;Inserts dOxygen documentation into python docstrings. This is done using</span>
<span class="sd">the xml export capabilities of dOxygen. The docstrings are inserted into</span>
<span class="sd">the desc dictionary for each function/class and will then be merged with</span>
<span class="sd">standard auto-docstrings as well as any user input from sidecar files.</span>

<span class="sd">This module is available as an xdress plugin by the name</span>
<span class="sd">``xdress.doxygen``.</span>

<span class="sd">:author: Spencer Lyon &lt;spencerlyon2@gmail.com&gt;</span>

<span class="sd">Giving Your Project dOxygen</span>
<span class="sd">===========================</span>

<span class="sd">This plugin works in two phases:</span>

<span class="sd">1. It takes user given doxygen settings (with sane defaults if not</span>
<span class="sd">   given) and runs dOxygen on the source project in ``rc.sourcedir``.</span>
<span class="sd">2. Alters the description dictionary generated by other xdress</span>
<span class="sd">   plugins (mainly ``xdress.autodescribe``) by inserting dOxygen output</span>
<span class="sd">   as class, method, and function docstrings in the</span>
<span class="sd">   `numpydoc &lt;https://pypi.python.org/pypi/numpydoc&gt;`_ format</span>

<span class="sd">Usage</span>
<span class="sd">-----</span>

<span class="sd">The usage of this plugin is very straightforward and comes in two steps:</span>

<span class="sd">1. Add ``xdress.doxygen`` to the list of plugins in your xdressrc.py</span>
<span class="sd">2. Define zero, or more of the (optional) rc variables given below.</span>
<span class="sd">   If These are not defined in xdressrc, the plugin will provide some</span>
<span class="sd">   sane initial values.</span>

<span class="sd">   a. ``doxygen_config``: A python dictionary mapping doxygen keys to</span>
<span class="sd">      their desired values. See</span>
<span class="sd">      `this &lt;http://www.stack.nl/~dimitri/doxygen/manual/config.html&gt;`_</span>
<span class="sd">      page in the dOxygen documentation for more information regarding</span>
<span class="sd">      the possible keys.</span>
<span class="sd">   b. ``doxyfile_name``: This is the name that should be given to the</span>
<span class="sd">      doxygen config file. The file will be written out in the directory</span>
<span class="sd">      containing xdressrc.py unless a path is specified for this</span>
<span class="sd">      variable. The path is assumed to be relative to the directory</span>
<span class="sd">      where ``xdress`` is run. The default value for this variable is</span>
<span class="sd">      ``&#39;doxyfile&#39;``.</span>
<span class="sd">   c. ``dox_template_ids``: This is list of strings that contain the</span>
<span class="sd">      template identifiers used in the C++ source. This is necessary</span>
<span class="sd">      for docstrings to be inserted for templated functions or classes.</span>
<span class="sd">      The default value is ``[&#39;T&#39;, &#39;S&#39;]``.</span>

<span class="sd">.. note::</span>

<span class="sd">    If you would like to see the default values for ``doxygen_config``,</span>
<span class="sd">    try ``from xdress.doxygen import default_doxygen_config``. The</span>
<span class="sd">    only changes that need to take place are as follows:</span>
<span class="sd">    ``PROJECT_NAME`` is assigned to ``rc.package``,  ``INPUT`` is</span>
<span class="sd">    assigned to ``rc.sourcedir`` and ``OUTPUT_DIRECTORY`` is assigned</span>
<span class="sd">    to ``rc.builddir``.</span>

<span class="sd">The user might accomplish these steps as follows::</span>

<span class="sd">   plugins = (&#39;xdress.stlwrap&#39;, &#39;xdress.autoall&#39;, &#39;xdress.autodescribe&#39;,</span>
<span class="sd">              &#39;xdress.doxygen&#39;, &#39;xdress.cythongen&#39;)</span>

<span class="sd">   # Set various doxygen configuration keys</span>
<span class="sd">   doxygen_config = {&#39;PROJECT_NAME&#39;: &#39;My Awesome Project&#39;,</span>
<span class="sd">                     &#39;EXTRACT_ALL&#39;: False,  # Note usage of python False</span>
<span class="sd">                     &#39;GENERATE_DOCBOOK&#39;: False,</span>
<span class="sd">                     &#39;GENERATE_LATEX&#39;: True  # Could be &#39;YES&#39; or True</span>
<span class="sd">                     }</span>

<span class="sd">   # Write the config file in the build directory</span>
<span class="sd">   doxyfile_name = &#39;./build/the_best_doxyfile&#39;</span>

<span class="sd">.. warning::</span>

<span class="sd">   The most common issue users make with this plugin is including it in</span>
<span class="sd">   the plugins list in the wrong order. Because xdress tries to execute</span>
<span class="sd">   plugins in the order they are listed in xdressrc, it is important</span>
<span class="sd">   that ``xdress.doxygen`` come after ``xdress.autodescribe``, but</span>
<span class="sd">   before ``xdress.cythongen``. autodescribe will ensure that the</span>
<span class="sd">   description dictionary is in place and ready for dOxygen to alter</span>
<span class="sd">   before cythongen has a chance to produce wrapper code.</span>

<span class="sd">dOygen API</span>
<span class="sd">==========</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">textwrap</span> <span class="kn">import</span> <span class="n">TextWrapper</span>
<span class="kn">from</span> <span class="nn">.plugins</span> <span class="kn">import</span> <span class="n">Plugin</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">newoverwrite</span><span class="p">,</span> <span class="n">parse_template</span>
<span class="kn">from</span> <span class="nn">.typesystem</span> <span class="kn">import</span> <span class="n">TypeMatcher</span><span class="p">,</span> <span class="n">MatchAny</span>

<span class="c"># XML conditional imports</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">lxml</span> <span class="kn">import</span> <span class="n">etree</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c"># Python 2.5</span>
        <span class="kn">import</span> <span class="nn">xml.etree.cElementTree</span> <span class="kn">as</span> <span class="nn">etree</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c"># Python 2.5</span>
            <span class="kn">import</span> <span class="nn">xml.etree.ElementTree</span> <span class="kn">as</span> <span class="nn">etree</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c"># normal cElementTree install</span>
                <span class="kn">import</span> <span class="nn">cElementTree</span> <span class="kn">as</span> <span class="nn">etree</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c"># normal ElementTree install</span>
                    <span class="kn">import</span> <span class="nn">elementtree.ElementTree</span> <span class="kn">as</span> <span class="nn">etree</span>
                <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                    <span class="k">pass</span>

<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
    <span class="nb">basestring</span> <span class="o">=</span> <span class="nb">str</span>

<span class="n">_LITERAL_INTS</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;^\d+$&#39;</span><span class="p">)</span>

<span class="c">##############################################################################</span>
<span class="c">##</span>
<span class="c">## -- Tools used in parsing</span>
<span class="c">##</span>
<span class="c">##############################################################################</span>
<span class="c">### Set up various TextWrapper instances</span>
<span class="c"># wrap_68 is for the core content of the docstring. It wraps, assuming there</span>
<span class="c"># will be 4 spaces preceding the text. This is suitable for the docstring</span>
<span class="c"># for a class or a function</span>
<span class="n">wrap_68</span> <span class="o">=</span> <span class="n">TextWrapper</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">68</span><span class="p">,</span> <span class="n">initial_indent</span><span class="o">=</span><span class="s">&#39; &#39;</span> <span class="o">*</span> <span class="mi">0</span><span class="p">,</span>
                      <span class="n">subsequent_indent</span><span class="o">=</span><span class="s">&#39; &#39;</span> <span class="o">*</span> <span class="mi">0</span><span class="p">)</span>

<span class="c"># wrap_64 is for core part of a class method. It wraps, assuming there</span>
<span class="c"># will be 8 spaces preceding the text</span>
<span class="n">wrap_64</span> <span class="o">=</span> <span class="n">TextWrapper</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">initial_indent</span><span class="o">=</span><span class="s">&#39; &#39;</span> <span class="o">*</span> <span class="mi">0</span><span class="p">,</span>
                      <span class="n">subsequent_indent</span><span class="o">=</span><span class="s">&#39; &#39;</span> <span class="o">*</span> <span class="mi">0</span><span class="p">)</span>

<span class="c"># attrib_wrap is for listing class attributes/methods</span>
<span class="n">attrib_wrap</span> <span class="o">=</span> <span class="n">TextWrapper</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">initial_indent</span><span class="o">=</span><span class="s">&#39; &#39;</span> <span class="o">*</span> <span class="mi">0</span><span class="p">,</span>
                          <span class="n">subsequent_indent</span><span class="o">=</span><span class="s">&#39; &#39;</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">_param_sec</span> <span class="o">=</span> <span class="s">&#39;Parameters</span><span class="se">\n</span><span class="s">----------&#39;</span>
<span class="n">_return_sec</span> <span class="o">=</span> <span class="s">&#39;Returns</span><span class="se">\n</span><span class="s">-------&#39;</span>

<span class="c"># Helpful re to be used when parsing class definitions.</span>
<span class="n">_no_arg_links</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(&lt;param&gt;</span><span class="se">\n</span><span class="s">\s+&lt;type&gt;)&lt;ref.+&gt;(\w+)&lt;/ref&gt;(.+&lt;/type&gt;)&#39;</span><span class="p">)</span>


<span class="c">##############################################################################</span>
<span class="c">##</span>
<span class="c">## -- Functions to create docstrings</span>
<span class="c">##</span>
<span class="c">##############################################################################</span>
<div class="viewcode-block" id="class_docstr"><a class="viewcode-back" href="../../libref/doxygen.html#xdress.doxygen.class_docstr">[docs]</a><span class="k">def</span> <span class="nf">class_docstr</span><span class="p">(</span><span class="n">class_dict</span><span class="p">,</span> <span class="n">desc_funcs</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate the main docstring for a class given a dictionary of the</span>
<span class="sd">    parsed dOxygen xml.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    class_dict : dict</span>
<span class="sd">        This is a dictionary that should be the return value of the</span>
<span class="sd">        function parse_class defined in this module</span>

<span class="sd">    desc_funcs : bool, optional(default=False)</span>
<span class="sd">        Whether or not to include the brief description of class methods</span>
<span class="sd">        in the main list of methods.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    msg : str</span>
<span class="sd">        The docstring to be inserted into the desc dictionary for the</span>
<span class="sd">        class.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">class_name</span> <span class="o">=</span> <span class="n">class_dict</span><span class="p">[</span><span class="s">&#39;kls_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;::&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">cls_msg</span> <span class="o">=</span> <span class="n">class_dict</span><span class="p">[</span><span class="s">&#39;public-func&#39;</span><span class="p">][</span><span class="n">class_name</span><span class="p">][</span><span class="s">&#39;detaileddescription&#39;</span><span class="p">]</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="n">wrap_68</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">cls_msg</span><span class="p">)</span>

    <span class="c"># Get a list of the methods and variables to list here.</span>
    <span class="n">methods</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">class_dict</span><span class="p">[</span><span class="s">&#39;members&#39;</span><span class="p">][</span><span class="s">&#39;methods&#39;</span><span class="p">]))</span>
    <span class="n">variables</span> <span class="o">=</span> <span class="n">class_dict</span><span class="p">[</span><span class="s">&#39;members&#39;</span><span class="p">][</span><span class="s">&#39;variables&#39;</span><span class="p">]</span>

    <span class="n">ivar_keys</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s">&#39;attrib&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">,</span> <span class="n">class_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">func_grp_keys</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s">&#39;func&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">,</span> <span class="n">class_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="c"># Flatten instance variables and functions from class dictionary.</span>
    <span class="n">ivar_items</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ivar_keys</span><span class="p">:</span>
        <span class="n">ivar_items</span> <span class="o">+=</span> <span class="n">class_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="n">ivars</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ivar_items</span><span class="p">)</span>

    <span class="n">func_items</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">func_grp_keys</span><span class="p">:</span>
        <span class="n">func_items</span> <span class="o">+=</span> <span class="n">class_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="n">funcs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">func_items</span><span class="p">)</span>

    <span class="c"># skip a line and begin Attributes section</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n\n</span><span class="s">&#39;</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="n">wrap_68</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="s">&#39;Attributes&#39;</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="n">wrap_68</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="s">&#39;----------&#39;</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
        <span class="n">desc</span> <span class="o">=</span> <span class="n">ivars</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&#39;briefdescription&#39;</span><span class="p">]</span>
        <span class="n">desc</span> <span class="o">+=</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="n">ivars</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&#39;detaileddescription&#39;</span><span class="p">]</span>
        <span class="n">var_msg</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s"> (</span><span class="si">%s</span><span class="s">) : </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ivars</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&#39;type&#39;</span><span class="p">],</span> <span class="n">desc</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="n">attrib_wrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">var_msg</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>

    <span class="c"># skip a line and begin Methods section</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n\n</span><span class="s">&#39;</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="n">wrap_68</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="s">&#39;Methods&#39;</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="n">wrap_68</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="s">&#39;-------&#39;</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>

    <span class="c"># sort them</span>
    <span class="n">methods</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="c"># Move the destructor from the bottom to be second.</span>
    <span class="n">methods</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">methods</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
        <span class="n">desc</span> <span class="o">=</span> <span class="n">funcs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&#39;briefdescription&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">desc_funcs</span><span class="p">:</span>
            <span class="n">fun_msg</span> <span class="o">=</span> <span class="n">i</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fun_msg</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s"> : </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">desc</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="n">attrib_wrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">fun_msg</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>

    <span class="c"># skip a line and begin notes section</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="n">wrap_68</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="s">&#39;Notes&#39;</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="n">wrap_68</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="s">&#39;-----&#39;</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>

    <span class="n">def_msg</span> <span class="o">=</span> <span class="s">&quot;This class was defined in </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">class_dict</span><span class="p">[</span><span class="s">&#39;file_name&#39;</span><span class="p">])</span>
    <span class="n">ns_msg</span> <span class="o">=</span> <span class="s">&#39;The class is found in the &quot;</span><span class="si">%s</span><span class="s">&quot; namespace&#39;</span>

    <span class="n">msg</span> <span class="o">+=</span> <span class="n">wrap_68</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">def_msg</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n\n</span><span class="s">&#39;</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="n">wrap_68</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">ns_msg</span> <span class="o">%</span> <span class="p">(</span><span class="n">class_dict</span><span class="p">[</span><span class="s">&#39;namespace&#39;</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">msg</span>

</div>
<div class="viewcode-block" id="func_docstr"><a class="viewcode-back" href="../../libref/doxygen.html#xdress.doxygen.func_docstr">[docs]</a><span class="k">def</span> <span class="nf">func_docstr</span><span class="p">(</span><span class="n">func_dict</span><span class="p">,</span> <span class="n">is_method</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate the docstring for a function given a dictionary of the</span>
<span class="sd">    parsed dOxygen xml.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    func_dict : dict</span>
<span class="sd">        This is a dictionary that should be the return value of the</span>
<span class="sd">        function parse_function defined in this module. If this is a</span>
<span class="sd">        class method it can be a sub-dictionary of the return value of</span>
<span class="sd">        the parse_class function.</span>

<span class="sd">    is_method : bool, optional(default=False)</span>
<span class="sd">        Whether or not to the function is a class method. If it is,</span>
<span class="sd">        the text will be wrapped 4 spaces earlier to offset additional</span>
<span class="sd">        indentation</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    msg : str</span>
<span class="sd">        The docstring to be inserted into the desc dictionary for the</span>
<span class="sd">        function.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_method</span><span class="p">:</span>
        <span class="n">wrapper</span> <span class="o">=</span> <span class="n">wrap_64</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">wrapper</span> <span class="o">=</span> <span class="n">wrap_68</span>

    <span class="n">detailed_desc</span> <span class="o">=</span> <span class="n">func_dict</span><span class="p">[</span><span class="s">&#39;detaileddescription&#39;</span><span class="p">]</span>
    <span class="n">brief_desc</span> <span class="o">=</span> <span class="n">func_dict</span><span class="p">[</span><span class="s">&#39;briefdescription&#39;</span><span class="p">]</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">brief_desc</span><span class="p">,</span> <span class="n">detailed_desc</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="n">args</span> <span class="o">=</span> <span class="n">func_dict</span><span class="p">[</span><span class="s">&#39;args&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">args</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;None&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="n">arg_str</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> : </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="n">arg</span><span class="p">][</span><span class="s">&#39;type&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s">&#39;desc&#39;</span> <span class="ow">in</span> <span class="n">args</span><span class="p">[</span><span class="n">arg</span><span class="p">]:</span>
                <span class="n">arg_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">arg</span><span class="p">][</span><span class="s">&#39;desc&#39;</span><span class="p">])</span>
            <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg_str</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

    <span class="n">returning</span> <span class="o">=</span> <span class="n">func_dict</span><span class="p">[</span><span class="s">&#39;ret_type&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">returning</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">rets</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;None&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rets</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">returning</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">rets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;res</span><span class="si">%i</span><span class="s"> : &#39;</span> <span class="o">%</span> <span class="n">i</span> <span class="o">+</span> <span class="n">returning</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ret</span> <span class="ow">in</span> <span class="n">returning</span><span class="p">:</span>
                <span class="n">rets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;res</span><span class="si">%i</span><span class="s"> : &#39;</span> <span class="o">%</span> <span class="n">i</span> <span class="o">+</span> <span class="n">ret</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c"># put main section in</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span>

    <span class="c"># skip a line and begin parameters section</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n\n</span><span class="s">&#39;</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="s">&#39;Parameters&#39;</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="s">&#39;----------&#39;</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>

    <span class="c"># add parameters</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">splitlines</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">more</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)):</span>
            <span class="n">more</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">more</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n\n</span><span class="s">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>

    <span class="c"># skip a line and begin returns section</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="s">&#39;Returns&#39;</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="s">&#39;-------&#39;</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>

    <span class="c"># add return values</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rets</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">splitlines</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)):</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>

    <span class="c"># TODO: add notes section like in class function above.</span>
    <span class="c"># # skip a line and begin notes section</span>
    <span class="c"># msg += wrapper.fill(&#39;Notes&#39;)</span>
    <span class="c"># msg += &#39;\n&#39;</span>
    <span class="c"># msg += wrapper.fill(&#39;-----&#39;)</span>
    <span class="c"># msg += &#39;\n&#39;</span>

    <span class="k">return</span> <span class="n">msg</span>

<span class="c">##############################################################################</span>
<span class="c">##</span>
<span class="c">## -- dOxygen setup and execution</span>
<span class="c">##</span>
<span class="c">##############################################################################</span>
<span class="c"># this is the meat of the template doxyfile template returned by: doxygen -g</span>
<span class="c"># NOTE: I have changed a few things like no html/latex generation.</span>

<span class="c"># NOTE: Also, there are three placeholders for format: project, output_dir,</span>
<span class="c">#       src_dir</span></div>
<span class="n">default_doxygen_config</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;DOXYFILE_ENCODING&#39;</span><span class="p">:</span> <span class="s">&#39;UTF-8&#39;</span><span class="p">,</span>
                          <span class="s">&#39;PROJECT_NAME&#39;</span><span class="p">:</span> <span class="s">&#39;project&#39;</span><span class="p">,</span>
                          <span class="s">&#39;PROJECT_NUMBER&#39;</span><span class="p">:</span> <span class="s">&#39;&quot;0.1&quot;&#39;</span><span class="p">,</span>
                          <span class="s">&#39;OUTPUT_DIRECTORY&#39;</span><span class="p">:</span> <span class="s">&#39;output_dir&#39;</span><span class="p">,</span>
                          <span class="s">&#39;CREATE_SUBDIRS&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;OUTPUT_LANGUAGE&#39;</span><span class="p">:</span> <span class="s">&#39;English&#39;</span><span class="p">,</span>
                          <span class="s">&#39;BRIEF_MEMBER_DESC&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;REPEAT_BRIEF&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;ALWAYS_DETAILED_SEC&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;INLINE_INHERITED_MEMB&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;FULL_PATH_NAMES&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SHORT_NAMES&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;JAVADOC_AUTOBRIEF&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;QT_AUTOBRIEF&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;MULTILINE_CPP_IS_BRIEF&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;INHERIT_DOCS&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SEPARATE_MEMBER_PAGES&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;TAB_SIZE&#39;</span><span class="p">:</span> <span class="s">&#39;4&#39;</span><span class="p">,</span>
                          <span class="s">&#39;OPTIMIZE_OUTPUT_FOR_C&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;OPTIMIZE_OUTPUT_JAVA&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;OPTIMIZE_FOR_FORTRAN&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;OPTIMIZE_OUTPUT_VHDL&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;MARKDOWN_SUPPORT&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;AUTOLINK_SUPPORT&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;BUILTIN_STL_SUPPORT&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;CPP_CLI_SUPPORT&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SIP_SUPPORT&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;IDL_PROPERTY_SUPPORT&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;DISTRIBUTE_GROUP_DOC&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SUBGROUPING&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;INLINE_GROUPED_CLASSES&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;INLINE_SIMPLE_STRUCTS&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;TYPEDEF_HIDES_STRUCT&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;LOOKUP_CACHE_SIZE&#39;</span><span class="p">:</span> <span class="s">&#39;0&#39;</span><span class="p">,</span>
                          <span class="s">&#39;EXTRACT_ALL&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;EXTRACT_PRIVATE&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;EXTRACT_PACKAGE&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;EXTRACT_STATIC&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;EXTRACT_LOCAL_CLASSES&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;EXTRACT_LOCAL_METHODS&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;EXTRACT_ANON_NSPACES&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;HIDE_UNDOC_MEMBERS&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;HIDE_UNDOC_CLASSES&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;HIDE_FRIEND_COMPOUNDS&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;HIDE_IN_BODY_DOCS&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;INTERNAL_DOCS&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;CASE_SENSE_NAMES&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;HIDE_SCOPE_NAMES&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SHOW_INCLUDE_FILES&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;FORCE_LOCAL_INCLUDES&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;INLINE_INFO&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SORT_MEMBER_DOCS&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SORT_BRIEF_DOCS&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SORT_MEMBERS_CTORS_1ST&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SORT_GROUP_NAMES&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SORT_BY_SCOPE_NAME&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;STRICT_PROTO_MATCHING&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_TODOLIST&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_TESTLIST&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_BUGLIST&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_DEPRECATEDLIST&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;MAX_INITIALIZER_LINES&#39;</span><span class="p">:</span> <span class="s">&#39;30&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SHOW_USED_FILES&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SHOW_FILES&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SHOW_NAMESPACES&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;QUIET&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;WARNINGS&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;WARN_IF_UNDOCUMENTED&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;WARN_IF_DOC_ERROR&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;WARN_NO_PARAMDOC&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;WARN_FORMAT&#39;</span><span class="p">:</span> <span class="s">&#39;&quot;$file:$line: $text&quot;&#39;</span><span class="p">,</span>
                          <span class="s">&#39;INPUT&#39;</span><span class="p">:</span> <span class="s">&#39;{src_dir}&#39;</span><span class="p">,</span>
                          <span class="s">&#39;INPUT_ENCODING&#39;</span><span class="p">:</span> <span class="s">&#39;UTF-8&#39;</span><span class="p">,</span>
                          <span class="s">&#39;RECURSIVE&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;EXCLUDE_SYMLINKS&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;EXAMPLE_RECURSIVE&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;FILTER_SOURCE_FILES&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SOURCE_BROWSER&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;INLINE_SOURCES&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;STRIP_CODE_COMMENTS&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;REFERENCED_BY_RELATION&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;REFERENCES_RELATION&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;REFERENCES_LINK_SOURCE&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;USE_HTAGS&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;VERBATIM_HEADERS&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;ALPHABETICAL_INDEX&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;COLS_IN_ALPHA_INDEX&#39;</span><span class="p">:</span> <span class="s">&#39;5&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_HTML&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;HTML_OUTPUT&#39;</span><span class="p">:</span> <span class="s">&#39;html&#39;</span><span class="p">,</span>
                          <span class="s">&#39;HTML_FILE_EXTENSION&#39;</span><span class="p">:</span> <span class="s">&#39;.html&#39;</span><span class="p">,</span>
                          <span class="s">&#39;HTML_COLORSTYLE_HUE&#39;</span><span class="p">:</span> <span class="s">&#39;220&#39;</span><span class="p">,</span>
                          <span class="s">&#39;HTML_COLORSTYLE_SAT&#39;</span><span class="p">:</span> <span class="s">&#39;100&#39;</span><span class="p">,</span>
                          <span class="s">&#39;HTML_COLORSTYLE_GAMMA&#39;</span><span class="p">:</span> <span class="s">&#39;80&#39;</span><span class="p">,</span>
                          <span class="s">&#39;HTML_TIMESTAMP&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;HTML_DYNAMIC_SECTIONS&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;HTML_INDEX_NUM_ENTRIES&#39;</span><span class="p">:</span> <span class="s">&#39;100&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_DOCSET&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;DOCSET_FEEDNAME&#39;</span><span class="p">:</span> <span class="s">&#39;&quot;Doxygen generated docs&quot;&#39;</span><span class="p">,</span>
                          <span class="s">&#39;DOCSET_BUNDLE_ID&#39;</span><span class="p">:</span> <span class="s">&#39;org.doxygen.Project&#39;</span><span class="p">,</span>
                          <span class="s">&#39;DOCSET_PUBLISHER_ID&#39;</span><span class="p">:</span> <span class="s">&#39;org.doxygen.Publisher&#39;</span><span class="p">,</span>
                          <span class="s">&#39;DOCSET_PUBLISHER_NAME&#39;</span><span class="p">:</span> <span class="s">&#39;Publisher&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_HTMLHELP&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_CHI&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;BINARY_TOC&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;TOC_EXPAND&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_QHP&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;QHP_NAMESPACE&#39;</span><span class="p">:</span> <span class="s">&#39;org.doxygen.Project&#39;</span><span class="p">,</span>
                          <span class="s">&#39;QHP_VIRTUAL_FOLDER&#39;</span><span class="p">:</span> <span class="s">&#39;doc&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_ECLIPSEHELP&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;ECLIPSE_DOC_ID&#39;</span><span class="p">:</span> <span class="s">&#39;org.doxygen.Project&#39;</span><span class="p">,</span>
                          <span class="s">&#39;DISABLE_INDEX&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_TREEVIEW&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;ENUM_VALUES_PER_LINE&#39;</span><span class="p">:</span> <span class="s">&#39;4&#39;</span><span class="p">,</span>
                          <span class="s">&#39;TREEVIEW_WIDTH&#39;</span><span class="p">:</span> <span class="s">&#39;250&#39;</span><span class="p">,</span>
                          <span class="s">&#39;EXT_LINKS_IN_WINDOW&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;FORMULA_FONTSIZE&#39;</span><span class="p">:</span> <span class="s">&#39;10&#39;</span><span class="p">,</span>
                          <span class="s">&#39;FORMULA_TRANSPARENT&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;USE_MATHJAX&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;MATHJAX_FORMAT&#39;</span><span class="p">:</span> <span class="s">&#39;HTML-CSS&#39;</span><span class="p">,</span>
                          <span class="s">&#39;MATHJAX_RELPATH&#39;</span><span class="p">:</span> <span class="s">&#39;http://cdn.mathjax.org/mathjax/latest&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SEARCHENGINE&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SERVER_BASED_SEARCH&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;EXTERNAL_SEARCH&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SEARCHDATA_FILE&#39;</span><span class="p">:</span> <span class="s">&#39;searchdata.xml&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_LATEX&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;LATEX_OUTPUT&#39;</span><span class="p">:</span> <span class="s">&#39;latex&#39;</span><span class="p">,</span>
                          <span class="s">&#39;LATEX_CMD_NAME&#39;</span><span class="p">:</span> <span class="s">&#39;latex&#39;</span><span class="p">,</span>
                          <span class="s">&#39;MAKEINDEX_CMD_NAME&#39;</span><span class="p">:</span> <span class="s">&#39;makeindex&#39;</span><span class="p">,</span>
                          <span class="s">&#39;COMPACT_LATEX&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;PAPER_TYPE&#39;</span><span class="p">:</span> <span class="s">&#39;a4&#39;</span><span class="p">,</span>
                          <span class="s">&#39;PDF_HYPERLINKS&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;USE_PDFLATEX&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;LATEX_BATCHMODE&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;LATEX_HIDE_INDICES&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;LATEX_SOURCE_CODE&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;LATEX_BIB_STYLE&#39;</span><span class="p">:</span> <span class="s">&#39;plain&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_RTF&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;RTF_OUTPUT&#39;</span><span class="p">:</span> <span class="s">&#39;rtf&#39;</span><span class="p">,</span>
                          <span class="s">&#39;COMPACT_RTF&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;RTF_HYPERLINKS&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_MAN&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;MAN_OUTPUT&#39;</span><span class="p">:</span> <span class="s">&#39;man&#39;</span><span class="p">,</span>
                          <span class="s">&#39;MAN_EXTENSION&#39;</span><span class="p">:</span> <span class="s">&#39;.3&#39;</span><span class="p">,</span>
                          <span class="s">&#39;MAN_LINKS&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_XML&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;XML_OUTPUT&#39;</span><span class="p">:</span> <span class="s">&#39;xml&#39;</span><span class="p">,</span>
                          <span class="s">&#39;XML_PROGRAMLISTING&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_DOCBOOK&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;DOCBOOK_OUTPUT&#39;</span><span class="p">:</span> <span class="s">&#39;docbook&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_AUTOGEN_DEF&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_PERLMOD&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;PERLMOD_LATEX&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;PERLMOD_PRETTY&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;ENABLE_PREPROCESSING&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;MACRO_EXPANSION&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;EXPAND_ONLY_PREDEF&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SEARCH_INCLUDES&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;SKIP_FUNCTION_MACROS&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;ALLEXTERNALS&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;EXTERNAL_GROUPS&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;EXTERNAL_PAGES&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;PERL_PATH&#39;</span><span class="p">:</span> <span class="s">&#39;/usr/bin/perl&#39;</span><span class="p">,</span>
                          <span class="s">&#39;CLASS_DIAGRAMS&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;HIDE_UNDOC_RELATIONS&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;HAVE_DOT&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;DOT_NUM_THREADS&#39;</span><span class="p">:</span> <span class="s">&#39;0&#39;</span><span class="p">,</span>
                          <span class="s">&#39;DOT_FONTNAME&#39;</span><span class="p">:</span> <span class="s">&#39;Helvetica&#39;</span><span class="p">,</span>
                          <span class="s">&#39;DOT_FONTSIZE&#39;</span><span class="p">:</span> <span class="s">&#39;10&#39;</span><span class="p">,</span>
                          <span class="s">&#39;CLASS_GRAPH&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;COLLABORATION_GRAPH&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GROUP_GRAPHS&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;UML_LOOK&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;UML_LIMIT_NUM_FIELDS&#39;</span><span class="p">:</span> <span class="s">&#39;10&#39;</span><span class="p">,</span>
                          <span class="s">&#39;TEMPLATE_RELATIONS&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;INCLUDE_GRAPH&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;INCLUDED_BY_GRAPH&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;CALL_GRAPH&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;CALLER_GRAPH&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GRAPHICAL_HIERARCHY&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;DIRECTORY_GRAPH&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">,</span>
                          <span class="s">&#39;DOT_IMAGE_FORMAT&#39;</span><span class="p">:</span> <span class="s">&#39;png&#39;</span><span class="p">,</span>
                          <span class="s">&#39;INTERACTIVE_SVG&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;DOT_GRAPH_MAX_NODES&#39;</span><span class="p">:</span> <span class="s">&#39;50&#39;</span><span class="p">,</span>
                          <span class="s">&#39;MAX_DOT_GRAPH_DEPTH&#39;</span><span class="p">:</span> <span class="s">&#39;0&#39;</span><span class="p">,</span>
                          <span class="s">&#39;DOT_TRANSPARENT&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;DOT_MULTI_TARGETS&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;GENERATE_LEGEND&#39;</span><span class="p">:</span> <span class="s">&#39;NO&#39;</span><span class="p">,</span>
                          <span class="s">&#39;DOT_CLEANUP&#39;</span><span class="p">:</span> <span class="s">&#39;YES&#39;</span><span class="p">}</span>
<span class="c">##############################################################################</span>
<span class="c">##</span>
<span class="c">## -- Functions to parse the xml</span>
<span class="c">##</span>
<span class="c">##############################################################################</span>


<div class="viewcode-block" id="parse_index_xml"><a class="viewcode-back" href="../../libref/doxygen.html#xdress.doxygen.parse_index_xml">[docs]</a><span class="k">def</span> <span class="nf">parse_index_xml</span><span class="p">(</span><span class="n">index_path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parses index.xml to get list of dictionaries for class and function</span>
<span class="sd">    names. Each dictionary will have as keys the object (function</span>
<span class="sd">    or class) names and the values will be dictionaries with (at least)</span>
<span class="sd">    key-value pairs representing the .xml file name where the</span>
<span class="sd">    information for that object can be found.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    index_path : str</span>
<span class="sd">        The path to index.xml. This is most likely to be provided by the</span>
<span class="sd">        run control instance.</span>

<span class="sd">    Returns</span>
<span class="sd">    classes : dict</span>
<span class="sd">        A dictionary of dictionaries, one for each class.</span>

<span class="sd">    funcs : dict</span>
<span class="sd">        A dictionary of dictionaries, one for each function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">index_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;index.xml&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">index_path</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">:</span>
            <span class="n">index_path</span> <span class="o">+=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&#39;index.xml&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">index_path</span> <span class="o">+=</span> <span class="s">&#39;index.xml&#39;</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">index_path</span><span class="p">)</span>

    <span class="n">funcs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">class_list</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;kind&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;class&#39;</span><span class="p">,</span>
                        <span class="n">root</span><span class="o">.</span><span class="n">iter</span><span class="p">(</span><span class="s">&#39;compound&#39;</span><span class="p">))</span>

    <span class="n">namespaces</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;kind&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;namespace&#39;</span><span class="p">,</span>
                        <span class="n">root</span><span class="o">.</span><span class="n">iter</span><span class="p">(</span><span class="s">&#39;compound&#39;</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">namespaces</span><span class="p">:</span>
        <span class="n">ns_name</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ns_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="o">*</span><span class="n">index_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ns_file_name</span> <span class="o">+=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&#39;namespace</span><span class="si">%s</span><span class="s">.xml&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ns_name</span><span class="p">)</span>
        <span class="n">ns_funcs</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;kind&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;function&#39;</span><span class="p">,</span>
                          <span class="n">i</span><span class="o">.</span><span class="n">iter</span><span class="p">(</span><span class="s">&#39;member&#39;</span><span class="p">))</span>

        <span class="c"># Create counter dict to keep track of duplicate names</span>
        <span class="n">f_name_cnts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ns_funcs</span><span class="p">:</span>
            <span class="n">f_name</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">refid</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;refid&#39;</span><span class="p">]</span>

            <span class="c"># Change the name if necessary</span>
            <span class="k">if</span> <span class="n">f_name</span> <span class="ow">in</span> <span class="n">f_name_cnts</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">orig</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f_name</span><span class="p">)</span>
                <span class="n">f_name</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f_name_cnts</span><span class="p">[</span><span class="n">f_name</span><span class="p">])</span>
                <span class="n">f_name_cnts</span><span class="p">[</span><span class="n">orig</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">f_name_cnts</span><span class="p">[</span><span class="n">f_name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="n">funcs</span><span class="p">[</span><span class="n">f_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;file_name&#39;</span><span class="p">:</span> <span class="n">ns_file_name</span><span class="p">,</span> <span class="s">&#39;refid&#39;</span><span class="p">:</span> <span class="n">refid</span><span class="p">,</span>
                             <span class="s">&#39;namespace&#39;</span><span class="p">:</span> <span class="n">ns_name</span><span class="p">}</span>

    <span class="k">for</span> <span class="n">kls</span> <span class="ow">in</span> <span class="n">class_list</span><span class="p">:</span>
        <span class="n">kls_defn</span> <span class="o">=</span> <span class="n">kls</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;::&#39;</span><span class="p">)</span>
        <span class="n">kls_ns</span> <span class="o">=</span> <span class="s">&#39;::&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">kls_defn</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">kls_name</span> <span class="o">=</span> <span class="n">kls_defn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">kls</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;refid&#39;</span><span class="p">]</span>
        <span class="n">kls_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;file_name&#39;</span><span class="p">:</span> <span class="n">file_name</span><span class="p">,</span> <span class="s">&#39;namespace&#39;</span><span class="p">:</span> <span class="n">kls_ns</span><span class="p">,</span> <span class="s">&#39;vars&#39;</span><span class="p">:</span> <span class="p">[],</span>
                    <span class="s">&#39;methods&#39;</span><span class="p">:</span> <span class="p">[]}</span>

        <span class="k">for</span> <span class="n">mem</span> <span class="ow">in</span> <span class="n">kls</span><span class="o">.</span><span class="n">iter</span><span class="p">(</span><span class="s">&#39;member&#39;</span><span class="p">):</span>
            <span class="n">mem_name</span> <span class="o">=</span> <span class="n">mem</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="k">if</span> <span class="n">mem</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;kind&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;variable&#39;</span><span class="p">:</span>
                <span class="n">kls_dict</span><span class="p">[</span><span class="s">&#39;vars&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mem_name</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mem</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;kind&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;function&#39;</span><span class="p">:</span>
                <span class="n">kls_dict</span><span class="p">[</span><span class="s">&#39;methods&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mem_name</span><span class="p">)</span>

        <span class="n">classes</span><span class="p">[</span><span class="n">kls_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">kls_dict</span>

    <span class="k">return</span> <span class="n">classes</span><span class="p">,</span> <span class="n">funcs</span>

</div>
<div class="viewcode-block" id="fix_xml_links"><a class="viewcode-back" href="../../libref/doxygen.html#xdress.doxygen.fix_xml_links">[docs]</a><span class="k">def</span> <span class="nf">fix_xml_links</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;For some reason I can&#39;t get doxygen to remove hyperlinks to members</span>
<span class="sd">    defined in the same file. This messes up the parsing. To overcome this</span>
<span class="sd">    I will just use a little regex magic to do it myself.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Get exiting file and read it in</span>
    <span class="n">ff</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">ff</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c"># make the substitutions, re-write the file, and close</span>
    <span class="n">new_text</span> <span class="o">=</span> <span class="n">_no_arg_links</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&#39;\g&lt;1&gt;\g&lt;2&gt;\g&lt;3&gt;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    <span class="n">ff</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">ff</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">new_text</span><span class="p">)</span>
    <span class="n">ff</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

</div>
<span class="k">def</span> <span class="nf">_parse_func</span><span class="p">(</span><span class="n">f_xml</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parse a function given the xml representation of it.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mem_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c"># Find detailed description</span>
    <span class="n">mem_dd</span> <span class="o">=</span> <span class="n">f_xml</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;detaileddescription&#39;</span><span class="p">)</span>
    <span class="n">dd_paras</span> <span class="o">=</span> <span class="n">mem_dd</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;para&#39;</span><span class="p">)</span>
    <span class="n">num_dd_paras</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dd_paras</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">num_dd_paras</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">mem_ddstr</span> <span class="o">=</span> <span class="n">dd_paras</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>

        <span class="c"># We need arg_dict around to check for later</span>
        <span class="n">arg_dict</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">elif</span> <span class="n">num_dd_paras</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c"># first one will have normal text</span>
        <span class="n">mem_ddstr</span> <span class="o">=</span> <span class="n">dd_paras</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>

        <span class="c"># Second one will have details regarding function args</span>
        <span class="n">arg_para</span> <span class="o">=</span> <span class="n">dd_paras</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">arg_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arg_para</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;parameterlist&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;parameteritem&#39;</span><span class="p">):</span>
            <span class="n">a_name</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;parameternamelist&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;parametername&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">a_desc</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;parameterdescription&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;para&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">arg_dict</span><span class="p">[</span><span class="n">a_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_desc</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c"># Didn&#39;t find anything, so just make an empty string</span>
        <span class="n">mem_ddstr</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>

        <span class="c"># We need arg_dict around to check for later</span>
        <span class="n">arg_dict</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="n">mem_dict</span><span class="p">[</span><span class="s">&#39;detaileddescription&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mem_ddstr</span>

    <span class="c"># Get return type</span>
    <span class="n">mem_dict</span><span class="p">[</span><span class="s">&#39;ret_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_xml</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;type&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="c"># Get argument types and names</span>
    <span class="c"># args = OrderedDict()</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">f_xml</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;param&#39;</span><span class="p">):</span>
        <span class="c"># add tuple of  arg type, arg name to arg_types list</span>
        <span class="n">arg_name</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;declname&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">arg_type</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;type&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">args</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="n">arg_type</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">arg_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c"># Add argument descriptions we just pulled out</span>
            <span class="n">args</span><span class="p">[</span><span class="n">arg_name</span><span class="p">][</span><span class="s">&#39;desc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg_dict</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span>

    <span class="n">args</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">args</span>
    <span class="n">mem_dict</span><span class="p">[</span><span class="s">&#39;args&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">args</span>

    <span class="c"># Get function signature</span>
    <span class="n">mem_argstr</span> <span class="o">=</span> <span class="n">f_xml</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;argsstring&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">mem_dict</span><span class="p">[</span><span class="s">&#39;arg_string&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mem_argstr</span>

    <span class="k">return</span> <span class="n">mem_dict</span>


<span class="k">def</span> <span class="nf">_parse_variable</span><span class="p">(</span><span class="n">v_xml</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parse a variable given the xml representation of it.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mem_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c"># Find detailed description</span>
    <span class="n">mem_dd</span> <span class="o">=</span> <span class="n">v_xml</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;detaileddescription&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">mem_ddstr</span> <span class="o">=</span> <span class="n">mem_dd</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;para&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">mem_ddstr</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>

    <span class="n">mem_dict</span><span class="p">[</span><span class="s">&#39;detaileddescription&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mem_ddstr</span>

    <span class="n">mem_dict</span><span class="p">[</span><span class="s">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_xml</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;type&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="k">return</span> <span class="n">mem_dict</span>


<span class="k">def</span> <span class="nf">_parse_common</span><span class="p">(</span><span class="n">xml</span><span class="p">,</span> <span class="n">the_dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse things in common for both variables and functions. This should</span>
<span class="sd">    be run after a more specific function like _parse_func or</span>
<span class="sd">    _parse_variable because it needs a member dictionary as an input.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    xml : etree.Element</span>
<span class="sd">        The xml representation for the member you would like to parse</span>

<span class="sd">    the_dict : dict</span>
<span class="sd">        The dictionary that has already been filled with more specific</span>
<span class="sd">        data. This dictionary is modified in-place and an updated</span>
<span class="sd">        version is returned.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    the_dict : dict</span>
<span class="sd">        The member dictionary that has been updated with the</span>
<span class="sd">        briefdescription and definition keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Find brief description</span>
    <span class="n">mem_bd</span> <span class="o">=</span> <span class="n">xml</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;briefdescription&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">mem_bdstr</span> <span class="o">=</span> <span class="n">mem_bd</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;para&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">mem_bdstr</span> <span class="o">=</span> <span class="n">mem_bdstr</span> <span class="k">if</span> <span class="n">mem_bdstr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="s">&#39;&#39;</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">mem_bdstr</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="n">the_dict</span><span class="p">[</span><span class="s">&#39;briefdescription&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mem_bdstr</span>

    <span class="c"># add member definition</span>
    <span class="n">the_dict</span><span class="p">[</span><span class="s">&#39;definition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xml</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;definition&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="k">return</span> <span class="n">the_dict</span>


<div class="viewcode-block" id="parse_function"><a class="viewcode-back" href="../../libref/doxygen.html#xdress.doxygen.parse_function">[docs]</a><span class="k">def</span> <span class="nf">parse_function</span><span class="p">(</span><span class="n">func_dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Takes a dictionary defining where the xml for the function is, does</span>
<span class="sd">    some function specific parsing and returns a new dictionary with</span>
<span class="sd">    the parsed xml.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">func_dict</span><span class="p">[</span><span class="s">&#39;file_name&#39;</span><span class="p">])</span>
    <span class="n">f_id</span> <span class="o">=</span> <span class="n">func_dict</span><span class="p">[</span><span class="s">&#39;refid&#39;</span><span class="p">]</span>
    <span class="n">compd_def</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;compounddef&#39;</span><span class="p">)</span>
    <span class="n">func_sec</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;kind&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;func&#39;</span><span class="p">,</span>
                      <span class="n">compd_def</span><span class="o">.</span><span class="n">iter</span><span class="p">(</span><span class="s">&#39;sectiondef&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">this_func</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">f_id</span><span class="p">,</span>
                       <span class="n">func_sec</span><span class="o">.</span><span class="n">iter</span><span class="p">(</span><span class="s">&#39;memberdef&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">ret_dict</span> <span class="o">=</span> <span class="n">_parse_func</span><span class="p">(</span><span class="n">this_func</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_parse_common</span><span class="p">(</span><span class="n">this_func</span><span class="p">,</span> <span class="n">ret_dict</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="parse_class"><a class="viewcode-back" href="../../libref/doxygen.html#xdress.doxygen.parse_class">[docs]</a><span class="k">def</span> <span class="nf">parse_class</span><span class="p">(</span><span class="n">class_dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parses a single class and returns a dictionary of dictionaries</span>
<span class="sd">    containing all the data for that class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    class_dict : dict</span>
<span class="sd">        A dictionary containing the following keys:</span>
<span class="sd">        [&#39;file_name&#39;, &#39;methods&#39;, &#39;vars&#39;]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    data : dict</span>
<span class="sd">        A dictionary with all docstrings for instance variables and</span>
<span class="sd">        class methods. This object is structured as follows::</span>

<span class="sd">            data</span>
<span class="sd">                &#39;protected-func&#39;</span>
<span class="sd">                    &#39;prot_func1&#39;</span>
<span class="sd">                        arg_string</span>
<span class="sd">                        args</span>
<span class="sd">                        briefdescription</span>
<span class="sd">                        detaileddescription</span>
<span class="sd">                        ret_type</span>
<span class="sd">                        definition</span>

<span class="sd">                &#39;public-func&#39;</span>
<span class="sd">                    &#39;pub_func_1&#39;</span>
<span class="sd">                        arg_string</span>
<span class="sd">                        args</span>
<span class="sd">                        briefdescription</span>
<span class="sd">                        detaileddescription</span>
<span class="sd">                        ret_type</span>
<span class="sd">                        definition</span>

<span class="sd">                &#39;protected-attrib&#39;</span>
<span class="sd">                    &#39;prot-attrib1&#39;</span>
<span class="sd">                        briefdescription</span>
<span class="sd">                        detaileddescription</span>
<span class="sd">                        type</span>
<span class="sd">                        definition</span>

<span class="sd">        This means that data is a 3-level dictionary. The levels go as</span>
<span class="sd">        follows:</span>

<span class="sd">        1. data</span>

<span class="sd">            - keys: Some of the following (more?): &#39;protected-func&#39;,</span>
<span class="sd">              &#39;protected-attrib&#39;, &#39;public-func&#39;,  &#39;public-static-attrib&#39;,</span>
<span class="sd">              &#39;publib-static-func&#39;, &#39;public-type&#39;</span>
<span class="sd">            - values: dictionaries of attribute types</span>

<span class="sd">        2. dictionaries of attribute types</span>

<span class="sd">            - keys: attribute names</span>
<span class="sd">            - values: attribute dictionaries</span>

<span class="sd">        3. attribute dictionaries</span>

<span class="sd">            - keys: arg_string, args, briefdescription, type, definition</span>
<span class="sd">              detaileddescription,</span>
<span class="sd">            - values: objects containing the actual data we care about</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The inner &#39;arg_string&#39; key is only applicable to methods as it</span>
<span class="sd">    contains the function signature for the arguments.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="n">class_dict</span>
    <span class="n">fn</span> <span class="o">=</span> <span class="n">c1</span><span class="p">[</span><span class="s">&#39;file_name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;.xml&#39;</span>

    <span class="n">fix_xml_links</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>

    <span class="n">croot</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
    <span class="n">compd_def</span> <span class="o">=</span> <span class="n">croot</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;compounddef&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">sec</span> <span class="ow">in</span> <span class="n">compd_def</span><span class="o">.</span><span class="n">iter</span><span class="p">(</span><span class="s">&#39;sectiondef&#39;</span><span class="p">):</span>
        <span class="c"># Iterate over all sections in the compound</span>
        <span class="n">sec_name</span> <span class="o">=</span> <span class="n">sec</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;kind&#39;</span><span class="p">]</span>
        <span class="n">sec_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">mem</span> <span class="ow">in</span> <span class="n">sec</span><span class="o">.</span><span class="n">iter</span><span class="p">(</span><span class="s">&#39;memberdef&#39;</span><span class="p">):</span>
            <span class="c"># Iterate over each member in the section</span>
            <span class="c"># get the kind. Will usually be variable or function.</span>
            <span class="n">m_kind</span> <span class="o">=</span> <span class="n">mem</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;kind&#39;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">m_kind</span> <span class="o">==</span> <span class="s">&#39;function&#39;</span><span class="p">:</span>
                <span class="c"># do special stuff for functions</span>
                <span class="n">mem_dict</span> <span class="o">=</span> <span class="n">_parse_func</span><span class="p">(</span><span class="n">mem</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">m_kind</span> <span class="o">==</span> <span class="s">&#39;variable&#39;</span><span class="p">:</span>
                <span class="n">mem_dict</span> <span class="o">=</span> <span class="n">_parse_variable</span><span class="p">(</span><span class="n">mem</span><span class="p">)</span>

            <span class="n">mem_dict</span> <span class="o">=</span> <span class="n">_parse_common</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">mem_dict</span><span class="p">)</span>

            <span class="n">mem_name</span> <span class="o">=</span> <span class="n">mem</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

            <span class="c"># Avoid overwriting methods with multiple implementations</span>
            <span class="c"># (especially constructors)</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">mem_name</span> <span class="ow">in</span> <span class="n">sec_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">mem_name</span> <span class="o">=</span> <span class="n">mem_name</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">mem_name</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">sec_dict</span><span class="p">[</span><span class="n">mem_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">mem_dict</span>

        <span class="n">data</span><span class="p">[</span><span class="n">sec_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">sec_dict</span>

    <span class="n">data</span><span class="p">[</span><span class="s">&#39;kls_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">compd_def</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;compoundname&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="n">data</span><span class="p">[</span><span class="s">&#39;members&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">data</span><span class="p">[</span><span class="s">&#39;members&#39;</span><span class="p">][</span><span class="s">&#39;methods&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">class_dict</span><span class="p">[</span><span class="s">&#39;methods&#39;</span><span class="p">]</span>
    <span class="n">data</span><span class="p">[</span><span class="s">&#39;members&#39;</span><span class="p">][</span><span class="s">&#39;variables&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">class_dict</span><span class="p">[</span><span class="s">&#39;vars&#39;</span><span class="p">]</span>

    <span class="n">c_fn</span> <span class="o">=</span> <span class="n">compd_def</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;location&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;file&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">data</span><span class="p">[</span><span class="s">&#39;file_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_fn</span>

    <span class="n">ns</span> <span class="o">=</span> <span class="s">&#39;::&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">compd_def</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;compoundname&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;::&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">data</span><span class="p">[</span><span class="s">&#39;namespace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ns</span>

    <span class="k">return</span> <span class="n">data</span>

<span class="c">##############################################################################</span>
<span class="c">##</span>
<span class="c">## -- Put it all together in a plugin! :)</span>
<span class="c">##</span>
<span class="c">##############################################################################</span>
</div>
<span class="n">_overload_msg</span> <span class="o">=</span> \
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This {f_type} was overloaded in the C-based source. To overcome this we</span>
<span class="sd">ill put the relevant docstring for each version below. Each version will begin</span>
<span class="sd">with a line of # characters.</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">merge_configs</span><span class="p">(</span><span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">old</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">d</span>


<span class="k">def</span> <span class="nf">dox_dict2str</span><span class="p">(</span><span class="n">dox_dict</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="n">new_line</span> <span class="o">=</span> <span class="s">&#39;{option} = {value}</span><span class="se">\n</span><span class="s">&#39;</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dox_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">_value</span> <span class="o">=</span> <span class="s">&#39;YES&#39;</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">_value</span> <span class="o">=</span> <span class="s">&#39;NO&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_value</span> <span class="o">=</span> <span class="n">value</span>

        <span class="n">s</span> <span class="o">+=</span> <span class="n">new_line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">value</span><span class="o">=</span><span class="n">_value</span><span class="p">)</span>

    <span class="c"># Don&#39;t need an empty line at the end</span>
    <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>


<div class="viewcode-block" id="XDressPlugin"><a class="viewcode-back" href="../../libref/doxygen.html#xdress.doxygen.XDressPlugin">[docs]</a><span class="k">class</span> <span class="nc">XDressPlugin</span><span class="p">(</span><span class="n">Plugin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add python docstrings (in numpydoc format) from dOxygen markup in</span>
<span class="sd">    the source to the generated cython wrapper.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># needs autodescribe to populate rc.classes, rc.functions, ect.</span>
    <span class="n">requires</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;xdress.base&#39;</span><span class="p">,</span> <span class="s">&#39;xdress.autodescribe&#39;</span><span class="p">)</span>

    <span class="n">defaultrc</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;doxygen_config&quot;</span><span class="p">:</span> <span class="n">default_doxygen_config</span><span class="p">,</span>
                 <span class="s">&quot;doxyfile_name&quot;</span><span class="p">:</span> <span class="s">&#39;doxyfile&#39;</span><span class="p">,</span>
                 <span class="s">&quot;dox_template_ids&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="s">&#39;S&#39;</span><span class="p">]}</span>

    <span class="n">rcupdaters</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;doxygen_config&#39;</span><span class="p">:</span> <span class="n">merge_configs</span><span class="p">}</span>

    <span class="n">rcdocs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&quot;doxygen_config&quot;</span><span class="p">:</span> <span class="s">&quot;A dictionary representation of a dOxygen configuration&quot;</span><span class="p">,</span>
        <span class="s">&quot;doxyfile_name&quot;</span><span class="p">:</span> <span class="s">&quot;The dOxygen configuration file name&quot;</span><span class="p">,</span>
        <span class="s">&quot;dox_template_ids&quot;</span><span class="p">:</span> <span class="s">&quot;Template argument names to hint to doxygen.&quot;</span>
        <span class="p">}</span>

<div class="viewcode-block" id="XDressPlugin.setup"><a class="viewcode-back" href="../../libref/doxygen.html#xdress.doxygen.XDressPlugin.setup">[docs]</a>    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Need setup method to get project, output_dir, and src_dir from</span>
<span class="sd">        rc and put them in the default_doxygen_config before running</span>
<span class="sd">        doxygen</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rc_params</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;PROJECT_NAME&#39;</span><span class="p">:</span> <span class="n">rc</span><span class="o">.</span><span class="n">package</span><span class="p">,</span>
                     <span class="s">&#39;OUTPUT_DIRECTORY&#39;</span><span class="p">:</span> <span class="n">rc</span><span class="o">.</span><span class="n">builddir</span><span class="p">,</span>
                     <span class="s">&#39;INPUT&#39;</span><span class="p">:</span> <span class="n">rc</span><span class="o">.</span><span class="n">sourcedir</span><span class="p">}</span>
        <span class="n">rc</span><span class="o">.</span><span class="n">doxygen_config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">rc_params</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="XDressPlugin.execute"><a class="viewcode-back" href="../../libref/doxygen.html#xdress.doxygen.XDressPlugin.execute">[docs]</a>    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Runs doxygen to produce the xml, then parses it and adds</span>
<span class="sd">        docstrings to the desc dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;doxygen: Running dOxygen&quot;</span><span class="p">)</span>
        <span class="n">fail_msg</span> <span class="o">=</span> <span class="s">&quot;doxygen: Couldn&#39;t find {tt} {name} in xml. Skipping it&quot;</span>
        <span class="n">fail_msg</span> <span class="o">+=</span> <span class="s">&quot; - it will not appear in wrapper docstrings.&quot;</span>

        <span class="n">build_dir</span> <span class="o">=</span> <span class="n">rc</span><span class="o">.</span><span class="n">builddir</span>

        <span class="c"># Create the doxyfile</span>
        <span class="n">doxyfile</span> <span class="o">=</span> <span class="n">dox_dict2str</span><span class="p">(</span><span class="n">rc</span><span class="o">.</span><span class="n">doxygen_config</span><span class="p">)</span>
        <span class="n">newoverwrite</span><span class="p">(</span><span class="n">doxyfile</span><span class="p">,</span> <span class="n">rc</span><span class="o">.</span><span class="n">doxyfile_name</span><span class="p">)</span>

        <span class="c"># Run doxygen</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span><span class="s">&#39;doxygen&#39;</span><span class="p">,</span> <span class="n">rc</span><span class="o">.</span><span class="n">doxyfile_name</span><span class="p">])</span>

        <span class="n">xml_dir</span> <span class="o">=</span> <span class="n">build_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&#39;xml&#39;</span>
        <span class="c"># Parse index.xml and obtain list of classes and functions</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;doxygen: Adding dOxygen to docstrings&quot;</span><span class="p">)</span>
        <span class="n">classes</span><span class="p">,</span> <span class="n">funcs</span> <span class="o">=</span> <span class="n">parse_index_xml</span><span class="p">(</span><span class="n">xml_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&#39;index.xml&#39;</span><span class="p">)</span>
        <span class="n">tm_classes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">classes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">parsed_class</span> <span class="o">=</span> <span class="n">parse_template</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parsed_class</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span>
                <span class="c"># This happens when it isn&#39;t a template type</span>
                <span class="n">tm_classes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">TypeMatcher</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c"># It should now be a tuple</span>
                <span class="c"># Replace template identifiers with MatchAny</span>
                <span class="n">p_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">parsed_class</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">rc</span><span class="o">.</span><span class="n">dox_template_ids</span><span class="p">:</span>
                        <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MatchAny</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">item</span> <span class="o">==</span> <span class="s">&#39;true&#39;</span><span class="p">:</span>
                        <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">item</span> <span class="o">==</span> <span class="s">&#39;false&#39;</span><span class="p">:</span>
                        <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">)</span> <span class="ow">and</span> \
                         <span class="n">_LITERAL_INTS</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

                <span class="n">tm_classes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">TypeMatcher</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">p_list</span><span class="p">))</span>

        <span class="c"># Go for the classes!</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">rc</span><span class="o">.</span><span class="n">classes</span><span class="p">:</span>
            <span class="n">kls</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">srcname</span>
            <span class="n">kls_mod</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">tarfile</span>

            <span class="c"># Parse the class</span>
            <span class="k">if</span> <span class="n">kls</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
                <span class="n">this_kls</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[</span><span class="n">kls</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># See if maybe this is a template type...</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">tm_classes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">val</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">kls</span><span class="p">):</span>
                        <span class="n">this_kls</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                        <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="n">fail_msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tt</span><span class="o">=</span><span class="s">&#39;class&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">kls</span><span class="p">))</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">this_kls</span><span class="p">[</span><span class="s">&#39;file_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">build_dir</span><span class="p">):</span>
                <span class="n">prepend_fn</span> <span class="o">=</span> <span class="n">build_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&#39;xml&#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span>
                <span class="n">this_kls</span><span class="p">[</span><span class="s">&#39;file_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prepend_fn</span> <span class="o">+</span> <span class="n">this_kls</span><span class="p">[</span><span class="s">&#39;file_name&#39;</span><span class="p">]</span>

            <span class="n">parsed</span> <span class="o">=</span> <span class="n">parse_class</span><span class="p">(</span><span class="n">this_kls</span><span class="p">)</span>

            <span class="c"># Make docstrings dictionary if needed</span>
            <span class="k">if</span> <span class="s">&#39;docstrings&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rc</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="n">kls_mod</span><span class="p">][</span><span class="n">kls</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">rc</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="n">kls_mod</span><span class="p">][</span><span class="n">kls</span><span class="p">][</span><span class="s">&#39;docstrings&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">rc</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="n">kls_mod</span><span class="p">][</span><span class="n">kls</span><span class="p">][</span><span class="s">&#39;docstrings&#39;</span><span class="p">][</span><span class="s">&#39;methods&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="c"># Add class docstring</span>
            <span class="n">rc</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="n">kls_mod</span><span class="p">][</span><span class="n">kls</span><span class="p">][</span><span class="s">&#39;docstrings&#39;</span><span class="p">][</span><span class="s">&#39;class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">class_docstr</span><span class="p">(</span><span class="n">parsed</span><span class="p">)</span>

            <span class="c"># Grab list of methods in rc.env</span>
            <span class="n">rc_methods</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rc</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="n">kls_mod</span><span class="p">][</span><span class="n">kls</span><span class="p">][</span><span class="s">&#39;methods&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>

            <span class="c"># Grab function group keys from parsed dOxygen</span>
            <span class="n">func_grp_keys</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s">&#39;func&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">,</span> <span class="n">parsed</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

            <span class="c"># Loop over rc.env methods and try to match them with dOxygen</span>
            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">rc_methods</span><span class="p">:</span>
                <span class="n">matches</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">func_grp_keys</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="c"># Grab the method dictionary and extend matches list</span>
                        <span class="n">m_names</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">parsed</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                        <span class="n">matches</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">parsed</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">m_names</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                        <span class="c"># Just try a different key and move on</span>
                        <span class="k">continue</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">m_ds</span> <span class="o">=</span> <span class="n">func_docstr</span><span class="p">(</span><span class="n">matches</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">is_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                    <span class="c"># m_ds = &#39;\n\n&#39; + m_ds</span>
                    <span class="n">rc</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="n">kls_mod</span><span class="p">][</span><span class="n">kls</span><span class="p">][</span><span class="s">&#39;docstrings&#39;</span><span class="p">][</span><span class="s">&#39;methods&#39;</span><span class="p">][</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">m_ds</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">ds_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">func_docstr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">is_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">]</span>
                    <span class="n">m_ds</span> <span class="o">=</span> <span class="n">_overload_msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f_type</span><span class="o">=</span><span class="s">&#39;method&#39;</span><span class="p">)</span>
                    <span class="n">m_ds</span> <span class="o">=</span> <span class="n">wrap_64</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">m_ds</span><span class="p">)</span>
                    <span class="n">m_ds</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n\n</span><span class="s">&#39;</span>

                    <span class="n">ds</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s">&#39;#&#39;</span> <span class="o">*</span> <span class="mi">64</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ds_list</span><span class="p">)</span>
                    <span class="n">m_ds</span> <span class="o">+=</span> <span class="n">ds</span>

                    <span class="n">rc</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="n">kls_mod</span><span class="p">][</span><span class="n">kls</span><span class="p">][</span><span class="s">&#39;docstrings&#39;</span><span class="p">][</span><span class="s">&#39;methods&#39;</span><span class="p">][</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">m_ds</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="n">fail_msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tt</span><span class="o">=</span><span class="s">&#39;method&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">m</span><span class="p">))</span>
                    <span class="k">continue</span>

        <span class="c"># And on to the functions.</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">rc</span><span class="o">.</span><span class="n">functions</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">srcname</span>
            <span class="n">func_mod</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">tarfile</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span>
                <span class="c"># It must be a tuple because it is a template function</span>
                <span class="c"># import pdb; pdb.set_trace()</span>

                <span class="n">func_name</span> <span class="o">=</span> <span class="n">func</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">func_name</span> <span class="o">=</span> <span class="n">func</span>

            <span class="c"># Pull out all parsed names that match the function name</span>
            <span class="c"># This is necessary because overloaded funcs will have</span>
            <span class="c"># multiple entries</span>
            <span class="n">matches</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">func_name</span><span class="p">),</span> <span class="n">funcs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

            <span class="k">if</span> <span class="n">matches</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">f_ds</span> <span class="o">=</span> <span class="n">func_docstr</span><span class="p">(</span><span class="n">parse_function</span><span class="p">(</span><span class="n">funcs</span><span class="p">[</span><span class="n">func_name</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c"># Overloaded function</span>
                    <span class="n">ds_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">func_docstr</span><span class="p">(</span><span class="n">parse_function</span><span class="p">(</span><span class="n">funcs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                               <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">]</span>
                    <span class="n">f_ds</span> <span class="o">=</span> <span class="n">_overload_msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f_type</span><span class="o">=</span><span class="s">&#39;function&#39;</span><span class="p">)</span>
                    <span class="n">f_ds</span> <span class="o">=</span> <span class="n">wrap_68</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">f_ds</span><span class="p">)</span>
                    <span class="n">f_ds</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n\n</span><span class="s">&#39;</span>
                    <span class="n">ds</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="s">&#39;#&#39;</span> <span class="o">*</span> <span class="mi">72</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ds_list</span><span class="p">)</span>
                    <span class="n">f_ds</span> <span class="o">+=</span> <span class="n">ds</span>

                <span class="n">rc</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="n">func_mod</span><span class="p">][</span><span class="n">func</span><span class="p">][</span><span class="s">&#39;docstring&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_ds</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="n">fail_msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tt</span><span class="o">=</span><span class="s">&#39;function&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">func</span><span class="p">))</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;Couldn&#39;t find function </span><span class="si">%s</span><span class="s"> in xml. Skipping it&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">func</span><span class="p">)</span>
                      <span class="o">+</span> <span class="s">&quot; - it will not appear in wrapper docstrings.&quot;</span><span class="p">)</span>
                <span class="k">continue</span>


        <span class="c"># TODO: Add the docstrings we found to the descriptions cache.</span>
        <span class="c">#       This is probably easier to do as I am putting them in the</span>
        <span class="c">#       rc.env places</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="../../index.html">
          <img class="logo" src="../../_static/HooverJoven.jpg" alt="Logo"/>
        </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../../np-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
    <li><a href="../../index.html">xdress 0.4-rc1 documentation</a> &raquo;</li>

          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    </div>

    <div class="footer">
        &copy; Copyright 2013, Anthony Scopatz.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div><script type="text/javascript">
    if(ga_enabled){
        document.write("<div class=\"footer\">This page uses <a href=\"http://analytics.google.com\">Google Analytics</a> to collect statistics. ");
        document.write("Click <button title=\"set cookie to disable analytics for this site\" class=\"link\" onclick=\"$.cookie('disable-ga', 'true', {expires: 3650, path: '/'}); window.location.reload(); return false; \">here</button> to disable analytics for this site.");
        document.write("</div>");
    }else{
        document.write("<div class=\"footer\">Google Analytics has been disabled. ");
        document.write("Click <button title=\"set cookie to re-enable analytics for this site\" class=\"link\" onclick=\"$.cookie('disable-ga', null, {path: '/'}); window.location.reload(); return false; \">here</button> to re-enable analytics for this site.");
    };
</script>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>